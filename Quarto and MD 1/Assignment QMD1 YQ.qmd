---
title: "Assignment QMD1 YQ"
format: html
author: "Yuqing Wu"
date: today
execute:
  echo: fenced
---

# 1. A brief description of the show (use italics for names).

*Suits* is an American television drama series created by Aaron Korsh, which premiered on June 23, 2011 on the USA Network. It revolves around Mike Ross (Patrick J. Adams), who begins working as a law associate for Harvey Specter (Gabriel Macht), despite never attending law school. The show focuses on Harvey and Mike managing to close cases, while maintaining Mike's secret.

The series was renewed for an eighth season on January 30, 2018. In January 2019, the series was renewed for a ninth and final season which premiered on July 17, 2019. During the course of the series, 134 episodes of Suits aired over nine seasons, between June 23, 2011, and September 25, 2019.

# 2. A photo with the logo or a shot from the show itself.

![The logo of Suits](https://en.wikipedia.org/wiki/File:Suits_Logo.png)

# 3. A summary of some basic statistics (e.g. on viewership or ratings).

According to `[wikipedia：List of Suits episodes]<https://en.wikipedia.org/wiki/List_of_Suits_episodes>`，the viewership data of the TV series is shown in the following table(Viewers (*in millions*))：

Table: Suits viewership by season

|Seasons | E01     | E02     | E03     | E04     | E05     | E06     | E07     | E08     | E09     | E10    | E11    | E12    | E13    | E14    | E15    | E16    |
|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|-------|
| S01| 4.64  | 3.89  | 4.53  | 4.38  | 4.38  | 4.44  | 4.03  | 3.96  | 4.45  | 3.82  | 3.96  | 3.47  |       |       |       |       |
| S02| 3.47  | 3.80  | 3.88  | 3.70  | 3.72  | 3.89  | 3.41  | 3.42  | 4.00  | 4.48  | 3.57  | 3.75  | 3.36  | 3.07  | 2.90  | 3.20  |
| S03| 2.93  | 2.89  | 2.48  | 2.99  | 2.79  | 2.76  | 2.79  | 3.52  | 2.95  | 3.16  | 2.28  | 2.28  | 2.35  | 2.53  | 2.50  | 2.40  |
| S04| 2.50  | 2.65  | 2.76  | 2.42  | 2.33  | 2.70  | 2.81  | 2.59  | 2.59  | 2.76  | 1.87  | 1.67  | 1.46  | 1.70  | 1.80  | 1.55  |
| S05| 2.13  | 2.27  | 2.16  | 2.38  | 2.10  | 2.16  | 2.08  | 2.31  | 2.30  | 2.34  | 1.74  | 1.51  | 1.71  | 1.58  | 1.73  | 1.71  |
| S06| 1.85  | 1.65  | 1.78  | 1.81  | 1.51  | 1.68  | 1.83  | 1.88  | 1.87  | 1.92  | 1.37  | 1.53  | 1.28  | 1.21  | 1.25  | 1.13  |
| S07| 1.40  | 1.36  | 1.41  | 1.41  | 1.29  | 1.47  | 1.35  | 1.51  | 1.64  | 1.68  | 1.18  | 1.06  | 0.95  | 0.99  | 1.09  | 1.07  |
| S08| 1.27	| 1.18	| 1.16	| 1.09	| 1.15	| 1.22	| 1.13	| 1.30	| 1.07	| 1.08	| 0.82	| 0.91	| 0.77	| 0.78	| 0.69	| 0.74  |
| S09| 1.04  |	1.04  |	0.94  |	1.00  |	0.96  |	1.05  |	1.07  |	0.97  |	0.96  |	0.86  |

create a data frame:
```{r}
# 将表格转换成数据框
suits_df <- read.table(text = "
Seasons	E01	E02	E03	E04	E05	E06	E07	E08	E09	E10	E11	E12	E13	E14	E15	E16
S01	4.64	3.89	4.53	4.38	4.38	4.44	4.03	3.96	4.45	3.82	3.96	3.47	NA	NA	NA	NA
S02	3.47	3.80	3.88	3.70	3.72	3.89	3.41	3.42	4.00	4.48	3.57	3.75	3.36	3.07	2.90	3.20
S03	2.93	2.89	2.48	2.99	2.79	2.76	2.79	3.52	2.95	3.16	2.28	2.28	2.35	2.53	2.50	2.40
S04	2.50	2.65	2.76	2.42	2.33	2.70	2.81	2.59	2.59	2.76	1.87	1.67	1.46	1.70	1.80	1.55
S05	2.13	2.27	2.16	2.38	2.10	2.16	2.08	2.31	2.30	2.34	1.74	1.51	1.71	1.58	1.73	1.71
S06	1.85	1.65	1.78	1.81	1.51	1.68	1.83	1.88	1.87	1.92	1.37	1.53	1.28	1.21	1.25	1.13
S07	1.40	1.36	1.41	1.41	1.29	1.47	1.35	1.51	1.64	1.68	1.18	1.06	0.95	0.99	1.09	1.07
S08	1.27	1.18	1.16	1.09	1.15	1.22	1.13	1.30	1.07	1.08	0.82	0.91	0.77	0.78	0.69	0.74
S09	1.04	1.04	0.94	1.00	0.96	1.05	1.07	0.97	0.96	0.86	NA	NA	NA	NA	NA	NA
", header = TRUE, stringsAsFactors = FALSE)

# 查看数据框的前几行
head(suits_df)

# 查看数据框的摘要统计信息
summary(suits_df)


```

```{r}
# 将 NA 替换为 0
suits_df[is.na(suits_df)] <- 0

```


```{r}
library(tidyr)
suits_df_long <- gather(suits_df, episode, viewership, -Seasons)

```

# 4. A graph of the viewership over time.

```{r}
# 4. Draw a graph of the viewership over time.
#install.packages("dplyr")
library(ggplot2)

suits_df_long <- tidyr::pivot_longer(suits_df, cols = -Seasons, names_to = "Episode", values_to = "Viewership")
suits_df_long$Episode <- gsub("E", "", suits_df_long$Episode)
suits_df_long$Episode <- as.numeric(suits_df_long$Episode)

ggplot(suits_df_long, aes(x = Episode, y = Viewership, group = Seasons, color = Seasons)) + 
  geom_line() + 
  ggtitle("Viewership over Time")

```

# 5. A graph of the episode-to-episode (or season-to-season) changes in viewership.

```{r}

# 3. Draw a bar plot of the total viewership for each season
# 计算每一季的总观看人数
seasons_df <- data.frame(
  Seasons = unique(suits_df$Seasons),
  Viewership = apply(suits_df[,-1], 1, sum)
)

# 绘制柱状图
ggplot(seasons_df, aes(x = Seasons, y = Viewership)) + 
  geom_col(fill = "blue") + 
  ggtitle("Total Viewership per Season")

```

# 6. A short description of the observed changes that includes inline references to numbers (e.g. the viewership decreased by insert_calculated_number between seasons 3 and 5).

The TV series *Suits* has 9 seasons and a total of 134 episodes, with a cumulative view count of about 189.63 million. The overall ratings of the series have been declining, and the highest-rated episode is the first episode of the first season, "Pilot," with a viewing count of approximately 4.64 million.The second season of Suits had the highest total viewership of about 57.62 million, while the ninth season had the lowest total viewership of only 9.89 million veiewers.

# 7. Make sure your report looks nice -> this time we’re mostly interested in the output and not necessarily the codes used to achieve it.

# 8. render your report and save it in the relevant folder of your repo.
#9. Commit the changes and push them to Github.
